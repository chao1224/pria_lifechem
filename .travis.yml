language: python

matrix:
  include:
    - python: 2.7
      env: KERAS_BACKEND=theano

notifications:
  email: false

before_install:
  - wget https://repo.continuum.io/archive/Anaconda2-4.3.0-Linux-x86_64.sh -O anaconda.sh
  - chmod 777 *
  - bash anaconda.sh -b -p $HOME/anaconda
  - export PATH="$HOME/anaconda/bin:$PATH"
  - conda install --yes pyyaml
  - conda install --yes HDF5
  - conda install --yes h5py
  - conda install --yes -c rdonnelly libgpuarray
  - conda install --yes -c rdonnelly pygpu
  - conda install --yes -c rdonnelly theano
  - conda install --yes -c conda-forge theano=0.8*
  - conda install --yes -c conda-forge keras=1.2*
  - conda install --yes scikit-learn=0.17*
  - conda install --yes -c rdkit rdkit-postgresql
  - conda install --yes -c r rpy2=2.8.5
  - conda install --yes -c bioconda r-prroc=1.1
  - conda install --yes -c auto croc=1.1.26

install:
  - pip install -e .

script:
  - python -c "import keras.backend"
  - sed -i -e 's/"backend":[[:space:]]*"[^"]*/"backend":\ "'$KERAS_BACKEND'/g' ~/.keras/keras.json;
  - echo -e "Running tests with the following config:\n$(cat ~/.keras/keras.json)"
